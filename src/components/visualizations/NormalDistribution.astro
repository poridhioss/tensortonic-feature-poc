---

---

<div class="viz-container">
  <h3 class="viz-title">Normal Distribution Explorer</h3>
  <p class="viz-description">Adjust the mean (μ) and standard deviation (σ) to see how they affect the bell curve.</p>

  <div class="controls">
    <div class="control-group">
      <label>Mean (μ): <span id="mean-value">0</span></label>
      <input type="range" id="mean-slider" min="-3" max="3" step="0.1" value="0" />
    </div>
    <div class="control-group">
      <label>Std Dev (σ): <span id="std-value">1</span></label>
      <input type="range" id="std-slider" min="0.5" max="3" step="0.1" value="1" />
    </div>
  </div>

  <div class="chart-area">
    <canvas id="normal-chart" width="600" height="300"></canvas>
  </div>

  <div class="stats-display">
    <div class="stat-item">
      <span class="stat-label">68% of data:</span>
      <span class="stat-value" id="range-68">-1 to 1</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">95% of data:</span>
      <span class="stat-value" id="range-95">-2 to 2</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">99.7% of data:</span>
      <span class="stat-value" id="range-99">-3 to 3</span>
    </div>
  </div>
</div>

<style>
  .viz-container {
    background-color: var(--zinc-900);
    border: 1px solid var(--zinc-700);
    border-radius: 12px;
    padding: 1.5rem;
    margin: 1.5rem 0;
  }

  .viz-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--zinc-100);
    margin: 0 0 0.5rem 0;
  }

  .viz-description {
    font-size: 0.9rem;
    color: var(--zinc-400);
    margin: 0 0 1.5rem 0;
  }

  .controls {
    display: flex;
    gap: 2rem;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
  }

  .control-group {
    flex: 1;
    min-width: 200px;
  }

  .control-group label {
    display: block;
    font-size: 0.85rem;
    color: var(--zinc-300);
    margin-bottom: 0.5rem;
  }

  .control-group input[type="range"] {
    width: 100%;
    height: 6px;
    -webkit-appearance: none;
    appearance: none;
    background: var(--zinc-700);
    border-radius: 3px;
    cursor: pointer;
  }

  .control-group input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--cyan-500);
    cursor: pointer;
  }

  .chart-area {
    margin-bottom: 1rem;
  }

  canvas {
    width: 100%;
    height: auto;
    display: block;
  }

  .stats-display {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .stat-item {
    background-color: var(--zinc-800);
    padding: 0.75rem 1rem;
    border-radius: 8px;
    flex: 1;
    min-width: 150px;
  }

  .stat-label {
    display: block;
    font-size: 0.75rem;
    color: var(--zinc-400);
    margin-bottom: 0.25rem;
  }

  .stat-value {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--emerald-500);
  }
</style>

<script>
  const canvas = document.getElementById('normal-chart') as HTMLCanvasElement;
  const ctx = canvas.getContext('2d')!;
  const meanSlider = document.getElementById('mean-slider') as HTMLInputElement;
  const stdSlider = document.getElementById('std-slider') as HTMLInputElement;
  const meanValue = document.getElementById('mean-value')!;
  const stdValue = document.getElementById('std-value')!;
  const range68 = document.getElementById('range-68')!;
  const range95 = document.getElementById('range-95')!;
  const range99 = document.getElementById('range-99')!;

  function normalPDF(x: number, mean: number, std: number): number {
    const coefficient = 1 / (std * Math.sqrt(2 * Math.PI));
    const exponent = -Math.pow(x - mean, 2) / (2 * Math.pow(std, 2));
    return coefficient * Math.exp(exponent);
  }

  function draw() {
    const mean = parseFloat(meanSlider.value);
    const std = parseFloat(stdSlider.value);
    const width = canvas.width;
    const height = canvas.height;
    const padding = { top: 20, right: 20, bottom: 40, left: 20 };

    ctx.clearRect(0, 0, width, height);

    // Update displays
    meanValue.textContent = mean.toFixed(1);
    stdValue.textContent = std.toFixed(1);
    range68.textContent = `${(mean - std).toFixed(1)} to ${(mean + std).toFixed(1)}`;
    range95.textContent = `${(mean - 2*std).toFixed(1)} to ${(mean + 2*std).toFixed(1)}`;
    range99.textContent = `${(mean - 3*std).toFixed(1)} to ${(mean + 3*std).toFixed(1)}`;

    const chartWidth = width - padding.left - padding.right;
    const chartHeight = height - padding.top - padding.bottom;

    // X range
    const xMin = -6;
    const xMax = 6;
    const xRange = xMax - xMin;

    // Find max Y for scaling
    const maxY = normalPDF(mean, mean, std);

    // Draw shaded regions (99.7%, 95%, 68%)
    const regions = [
      { multiplier: 3, color: 'rgba(139, 92, 246, 0.15)' },
      { multiplier: 2, color: 'rgba(6, 182, 212, 0.2)' },
      { multiplier: 1, color: 'rgba(16, 185, 129, 0.3)' },
    ];

    regions.forEach(region => {
      ctx.beginPath();
      const startX = mean - region.multiplier * std;
      const endX = mean + region.multiplier * std;

      for (let px = 0; px <= chartWidth; px++) {
        const x = xMin + (px / chartWidth) * xRange;
        if (x >= startX && x <= endX) {
          const y = normalPDF(x, mean, std);
          const canvasX = padding.left + px;
          const canvasY = padding.top + chartHeight - (y / maxY) * chartHeight * 0.9;

          if (px === 0 || x - 0.01 < startX) {
            ctx.moveTo(canvasX, padding.top + chartHeight);
            ctx.lineTo(canvasX, canvasY);
          } else {
            ctx.lineTo(canvasX, canvasY);
          }
        }
      }

      const endPx = padding.left + ((endX - xMin) / xRange) * chartWidth;
      ctx.lineTo(endPx, padding.top + chartHeight);
      ctx.closePath();
      ctx.fillStyle = region.color;
      ctx.fill();
    });

    // Draw curve
    ctx.beginPath();
    ctx.strokeStyle = '#06b6d4';
    ctx.lineWidth = 3;

    for (let px = 0; px <= chartWidth; px++) {
      const x = xMin + (px / chartWidth) * xRange;
      const y = normalPDF(x, mean, std);
      const canvasX = padding.left + px;
      const canvasY = padding.top + chartHeight - (y / maxY) * chartHeight * 0.9;

      if (px === 0) {
        ctx.moveTo(canvasX, canvasY);
      } else {
        ctx.lineTo(canvasX, canvasY);
      }
    }
    ctx.stroke();

    // Draw mean line
    const meanPx = padding.left + ((mean - xMin) / xRange) * chartWidth;
    ctx.beginPath();
    ctx.strokeStyle = '#f59e0b';
    ctx.lineWidth = 2;
    ctx.setLineDash([5, 5]);
    ctx.moveTo(meanPx, padding.top);
    ctx.lineTo(meanPx, padding.top + chartHeight);
    ctx.stroke();
    ctx.setLineDash([]);

    // Label
    ctx.fillStyle = '#f59e0b';
    ctx.font = 'bold 12px Inter, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText(`μ = ${mean.toFixed(1)}`, meanPx, padding.top - 5);

    // X-axis
    ctx.beginPath();
    ctx.strokeStyle = '#52525b';
    ctx.lineWidth = 1;
    ctx.moveTo(padding.left, padding.top + chartHeight);
    ctx.lineTo(width - padding.right, padding.top + chartHeight);
    ctx.stroke();

    // X-axis labels
    ctx.fillStyle = '#71717a';
    ctx.font = '11px Inter, sans-serif';
    for (let x = -6; x <= 6; x += 2) {
      const px = padding.left + ((x - xMin) / xRange) * chartWidth;
      ctx.fillText(x.toString(), px, height - 10);
    }
  }

  meanSlider.addEventListener('input', draw);
  stdSlider.addEventListener('input', draw);
  draw();
</script>
